# Tableau Worksheets

  - When working in Tableau, you start your work within a Tableau workbook. The workbook is a file structure made up of sheets, similar to Excel or Google Sheets. Each sheet within the Tableau workbook can be one of three types: a worksheet, a dashboard, or a story.

## Dimensions and Measures
**Dimensions** are data fields that contain qualitative values. **Qualitative** data is conceptual and descriptive. Qualitative data can be expressed using text, symbols, and characteristics (text, geographic data, names, etc.).

**Measures** are data fields that contain quantitative or numerical values. **Quantitative** data can be measured, counted, and expressed using numbers (sales, number of records, profit, etc.).

Tableau programmatically categorizes fields into these groups to tell you if a field can be numerically manipulated (a **measure**) or not (a **dimension**). 

In Tableau, when a **measure** is added to the visualization, the field is automatically aggregated. Aggregation means that the field is summarized using mathematical equations such as sum total, median, or average. 

Because a dimension cannot be measured, it is used to create groups.

## Discrete and Continuous

  **Discrete**: Individually separate and distinct. When a discrete field is plotted, there are gaps between each point of data — signifying that each point of data is separate from the whole.
  - An example of discrete would be counties. You’re always in a specific county, and there are county lines — the moment you cross over the county line, the name of the county you’re in changes. There is no gradual transition — the name of the county “jumps” from one to the next.
  - In Tableau, discrete fields are shown in the worksheet in blue.
  - A blue "pill" that says "Discrete."

  **Continuous**: Forming an unbroken whole; without interruption. When a continuous field is plotted on a line graph, the line is unbroken.

  - An example of continuous would be your weight: There are an infinite number of values your weight could be. In other words, there is always another weight between any two weights (e.g., between 152.46 lbs and 152.47 lbs is 152.465 lbs). Continuous data is always a number.
  - In Tableau, continuous fields are shown in the worksheet as green.

  - Fields in Tableau are categorized as either a dimension or a measure and are also categorized as either discrete or continuous. This means that there are four combinations:

    - Discrete dimension
    - Continuous dimension
    - Discrete measure
    - Continuous measure
  
  This is where the physical locations of dimensions and measures as well as the color coding of discrete and continuous come in handy. Recall the following:
    - Dimensions are on the top of the sidebar.
    - Measures are at the bottom of the sidebar.
    - Discrete fields are blue.
    - Continuous fields are green.

  This system allows you to easily identify whether a field is being treated as a dimension or a measure, and whether it is discrete or continuous.
  
## Generated Fields
  - Generated fields are fields that are automatically generated by Tableau and do not come directly from your data source. These are created to help Tableau build visualizations such as maps and provide you with more ways of manipulating the data.
  - You can see these generated fields at the bottom of both the dimensions and measures. Generated fields are **_italicized_** to distinguish them as additional fields rather than core fields from the dataset.

## Measure names and Measure Values
  - Measure Names and Measure Values are two of Tableau's generated fields. They allow you to quickly summarize all of the numerical data (measures) within a data source.

### Worksheet Organization
  - Organize worksheets by creating folders and hierarchies.

#### FOLDERS
  - Creating folders in Tableau is simple, although you'll need to first change one setting in order to create folders. By default, Tableau orders the sidebar based on the data source tables. If you would like to use folders, then you'll need to change this setting so that it's grouped by folders. This can be done simply by selecting the arrow to the right of the search bar and then "Group by Folder."
  - From there, to create a folder, simply right-click one of the fields you would like to put inside a folder, and select "Folders" → "Create Folder..."
  - From there, you'll give your folder a name and then drag any additional fields you would like directly into the folder.
  - **Note that if you don't update the sidebar setting to "group by folder," then you will not have the option to create folders.**

#### HIERARCHIES
  - A Tableau Hierarchy is another organizational structure in which dimensional metadata is organized by position.
  - Tableau will sometimes assume and implement hierarchies itself, but they can also be created manually. The icon used to represent a hierarchy is similar to what you may have seen with a typical family tree, with a parent node branching off to two child nodes. Hierarchies give a rank to the metadata and allow for the data to be used in drill-down reports, essentially specifying what fields makeup or "belong to" other fields. To drill down in Tableau means to break data into smaller pieces.

#### GROUPS
  - Related fields are placed in folders.
  - Related values are placed in groups.

### WORKSHEET CALCULATIONS
  - Aggregate functions
  - Calculated fields
  - String functions
  - Logic statements
  - Table calculations

#### Calculated fields in worksheet
  - All calculated fields can be identified with the equal sign (=) in front of each field's data type (which, in worksheets, is displayed to the left of the field name in the sidebar).
  - Right-click the field you would like to include in your calculated field → "Create" → "Calculated Field..." This will start you off with the field name that you initially right-clicked in your calculation.
  - Alternatively, in the top menu bar above the toolbar, select "Analysis" → "Create Calculated Field..." This will start you off with a blank calculation.

#### Aggregate vs. Non-Aggregate Functions in Calculated Fields
  - Aggregate functions perform calculations on groups of data, while non-aggregate functions perform calculations on individual data points.

#### String Functions
  - Take a moment to read through the descriptions of some common string manipulation functions.
    String Function | Description
    |---|---|
    CONTAINS(string, substring) | Returns "True" if the given string contains the specified substring.
    LEFT(string, number) | Returns all characters from the left of the specified character.
    LEN(string) | Returns the length of a string in terms of number of characters.
    REPLACE(string, substring, replacement) | Searches a string for a specific substring and replaces it with a specified string.
    RIGHT(string, number) | Returns all characters from the right of the specified character.
    TRIM(string) | Returns the string with the leading and trailing spaces removed.
  - [Full list of string functions in Tableau](http://help.tableau.com/current/pro/desktop/en-us/functions_functions_string.htm)

### IF/THEN STATEMENT
    
    IF SUM([Sales]) >= 10000 AND SUM([Sales]) <= 15000 THEN "Above Benchmark"
    ELSEIF SUM([Sales]) > 15000 THEN "Well Above Benchmark"
    ELSEIF SUM([Sales]) >= 5000 AND SUM([Sales]) < 10000 THEN "Below Benchmark"
    ELSE "Well Below Benchmark"
    END

### CASE/WHEN STATEMENT
    CASE [Field]
      WHEN 1 THEN "Red"
      WHEN 2 THEN "Green"
      ELSE "Purple"
    END

#### TABLE CALCULATION
  - **Table calculations** calculate data based on only what is in a present view after all other calculations have been processed, allowing you to further manipulate data after you have created the visualization.
  - These types of calculations differ from calculated fields in that they are created and reside specifically within one visualization or view.

    ##### Creating a Table Calculation
    - To create a customized table calculation, right-click on a field and select "Add Table Calculation..."
   Within this interface, you can customize how a calculation affects the data.

    - The Table Calculation interface can be broken up into three distinct portions, as highlighted below.
      1. Calculation Type - This is a dropdown menu that lets you choose which of the common calculations you'd like to customize.
      2. Compute Using - This is a list of all the structures within the table you are editing that you'd like to affect with the table calculation. You can decide what gets calculated and what does not (the "Show calculation assistance" option below allows you to see what is affected).
      3. Show calculation assistance - This option allows the user to see which portions of the data will be affected by highlighting the affected portion in yellow.
    ## Benefits
    - The first benefit is that, because you are only running calculations on the subset of data in the present visualization (table calculations do not run on any data that has been filtered out), they tend to be more efficient.
    - Second, and perhaps most importantly, table calculations show the relationship between the values of a specific field.


### Key Takeaways
  - Calculated fields can be created in both the data source page and in worksheets. 
  - Calculated fields allow users to use existing data within calculations that can help uncover and visualize new information.
  - Functions can be classified as either aggregate functions or non-aggregate functions (e.g., string, date, and number functions).
    - Aggregate functions should be used when you want to perform calculations across multiple rows of data, such as finding the sum or average of an entire field.
    - Non-aggregate functions should be used when you want to perform calculations on individual data points, such as converting a date field to a specific format or splitting a field.
  - Aggregation in Tableau means that the field is summarized using mathematical equations such as sum total, median, or average. In other words, it means to "roll up" the data and present it in a summary form using statistical functions known as aggregate functions.
  - There are two ways to edit the way a field is aggregated:
    - Edit the worksheet aggregation - This changes how the measure is aggregated on a specific worksheet.
    - Edit the default aggregation - This changes how the measure is aggregated across the entire workbook.
  - In Tableau, the IF/THEN logic statement uses Boolean expressions to test a condition logically and then produce a result.
  - Another logic statement is the CASE/WHEN statement. In most scenarios, these effectively have the same function as IF/THEN statements.       - However, there are a few differences:
      - IF/THEN statements can handle asking about different fields within each logic statement.
      - CASE/WHEN statements are limited to checking for equality (=), whereas IF/THEN statements can handle other symbols (=, <, >, <=, and >=).
    - Generally speaking, CASE/WHEN statements are faster than IF/THEN statements.
  - Table calculations are similar to calculated fields, but they calculate data based only on what is in a present view after all other calculations have been processed, allowing you to further manipulate data after you have created the visualization.
  - There are two key benefits to using table calculations:
    - Because you are only running calculations on the subset of data in the present visualization (table calculations do not run on any data that has been filtered out), they tend to be more efficient.
    - Perhaps most importantly, table calculations show the relationship between the values of a specific field.
    - To create a table calculation, you have two options:
        - Quick table calculations, which are commonly used table calculations that are pre-built into Tableau OR
Table calculations, which are highly customizable.
        - The "Table Calculation" interface can be broken into three distinct portions: 
          1. Use "Calculation Type" to choose which calculations to customize.
          2. Use "Compute Using" to decide what gets calculated.
          3. Use "Show Calculation Assistance" to see which portions of the data will be affected.
